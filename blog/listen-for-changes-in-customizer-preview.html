<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <!-- Page Info -->
        <title>
            Listen for changes in Customizer Preview ! &ndash; &lbrace; LebCit
            &rbrace;
        </title>
        <meta name="theme-color" content="#3d4f5d" />
        <meta
            name="description"
            content="This post is about how to listen for any changes in WordPress Customizer Preview."
        />

        <!-- Favicon -->
        <link
            rel="icon"
            type="image/png"
            sizes="16x16"
            href="/img/favicon//favicon-16x16.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="32x32"
            href="/img/favicon/favicon-32x32.png"
        />
        <link
            rel="apple-touch-icon"
            sizes="180x180"
            href="/img/favicon/apple-touch-icon.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="192x192"
            href="/img/favicon/android-chrome-192x192.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="512x512"
            href="/img/favicon/android-chrome-512x512.png"
        />

        <!-- Styles -->
        <link rel="stylesheet" href="/vendor/normalize-min.css" />
        <link rel="stylesheet" href="/style.css" />
    </head>

    <body class="changes-customizer">
        <div id="layout" class="grid">
            <a class="skip-link screen-reader-text" href="#content"
                >Skip to content</a
            >

            <main-navigation></main-navigation>

            <the-header></the-header>

            <div id="content" class="content unit-1 unit-lg-3-5">
                <!-- A wrapper for every single post -->
                <div class="single-post">
                    <!-- A single post -->
                    <section class="post-single">
                        <header class="post-header">
                            <h2 class="post-title">
                                Listen for changes in Customizer Preview !
                            </h2>

                            <p class="post-meta">
                                Posted on
                                <span class="posted-on">24 May 2020</span>
                                under
                                <span class="post-category">Tips & Tricks</span>
                            </p>
                        </header>

                        <div class="post-content">
                            <p>
                                <em
                                    >This post is about how to listen for any
                                    changes in WordPress Customizer Preview.</em
                                >
                            </p>
                            <p>
                                I always like to assume that the reader maybe a
                                beginner, like I was a long time ago, and
                                explain everything from A to Z, so she/he can
                                follow the tutorial or jump to any part
                                according to her/his experience.
                            </p>
                            <p>
                                For simplicity and practice, as usual 😊, I’ll
                                be using an
                                <a
                                    target="_blank"
                                    rel="external noopener"
                                    href="https://underscores.me/"
                                    aria-label=" (opens in a new tab)"
                                    >_s</a
                                >
                                (underscores) generated theme, and call it
                                <em>Customizer Preview</em> 😉. It’s a 1 minute
                                process, so don’t be afraid, type in the
                                <em>Theme Name,</em> download it, and upload it
                                like any other theme under
                                <em
                                    >Appearance &gt; Themes &gt; Add New &gt;
                                    Upload Theme</em
                                >.<br />
                                Now you’re all set and we can begin.
                            </p>
                            <h2>Understanding how it’s related</h2>
                            <p>
                                In the
                                <a
                                    target="_blank"
                                    rel="external noopener"
                                    href="https://codex.wordpress.org/Functions_File_Explained"
                                    aria-label=" (opens in a new tab)"
                                    ><strong>functions.php</strong></a
                                >
                                file, search for <em>customizer.php</em>, you’ll
                                find a line like this one :
                            </p>
                            <pre><code>require get_template_directory() . '/inc/customizer.php';</code></pre>
                            <p>
                                So the file
                                <a
                                    target="_blank"
                                    rel="external noopener"
                                    href="https://codex.wordpress.org/Theme_Customization_API"
                                    aria-label=" (opens in a new tab)"
                                    ><strong>customizer.php</strong></a
                                >
                                is located in a folder named
                                <strong><em>inc</em></strong> at the root of the
                                theme.<br />
                                If you look inside this file, at the very
                                bottom, you’ll find a little block of code like
                                this one :
                            </p>
                            <pre><code>/**
 * Binds JS handlers to make Theme Customizer preview reload changes asynchronously.
 */
function customizer_preview_customize_preview_js() {
    wp_enqueue_script( 'customizer-preview-customizer', get_template_directory_uri() . '/js/customizer.js', array( 'customize-preview' ), '20151215', true );
}
add_action( 'customize_preview_init', 'customizer_preview_customize_preview_js' );</code></pre>
                            <p>
                                So here, we have a call for another file
                                <strong>customizer.js</strong>, located in a
                                folder named <strong><em>js</em></strong> at the
                                root of the theme.<br />
                                If you take a look inside it, you’ll find a
                                bunch of code allowing us to view the changes we
                                make from the Customizer.
                            </p>
                            <h2>The Customizer’s Parts</h2>
                            <p>
                                When you open the Customizer, you’ll find
                                yourself in front of screen with two parts :<br />a-
                                the <strong>Customizer Pane</strong> where the
                                <strong>Controls</strong> (like Background
                                Image) of a theme are defined in
                                <strong>customizer.php</strong><br />
                                b- the <strong>Customizer Preview</strong> where
                                the <strong>Settings</strong> defined in
                                <strong>customizer.js</strong> act like a bridge
                                between the Controls and their related Partials.
                            </p>
                            <p>
                                A <strong>Partial</strong> is simply a
                                particular part of a theme like the header, the
                                body, the footer, the logo, the site title, the
                                tagline… and so on.
                            </p>
                            <p>
                                As an example, you could have a Control to
                                control the site title color by a Setting
                                linking that color Control to the desired
                                Partial (here the site title).<br />Now, when
                                you change the color Control in the Pane, the
                                defined Setting for this color Control calls the
                                related Partial in the Preview and tells him to
                                change according to the modifications of his
                                Control.
                            </p>
                            <p>
                                If you want to dive more into that, you can read
                                about the
                                <a
                                    target="_blank"
                                    rel="external noopener"
                                    href="https://developer.wordpress.org/themes/customize-api/customizer-objects/"
                                    aria-label=" (opens in a new tab)"
                                    >Customizer Objects</a
                                >
                                in the Theme Handbook.
                            </p>
                            <h2>Listening to changes</h2>
                            <p>
                                At this point, you understand how the
                                Customizer’s parts communicate.<br />But what if
                                you need to listen for changes in the Preview
                                ?<br />This will be mostly a need if you are a
                                developer or in the process of becoming one 💪👍
                            </p>
                            <p>
                                Quick quizz. Where do you think the following
                                code will go ?<br />Don’t look under the code
                                before giving an answer 😁
                            </p>
                            <pre><code>// Listen for any changes in the Customizer Preview.
wp.customize.bind( 'change', function ( setting ) {
    // Target the Setting, let's take background_image as an example.
    if ( 0 === setting.id.indexOf( 'background_image' ) ) {
        // The background is empty by default.
                // So, we begin by listening to a non empty value,
                // to catch the first change when it happens !
        if ((setting._value) != "") {
            console.log('I Now Have A Background 🙂');
        } else {
            console.log('I Do Not Have A Background 🙁');
        }
    }
});</code></pre>

                            <p>
                                What does this code do ?<br />It listen to any
                                <code>'change'</code> of a defined
                                <code>( setting )</code>.<br />Remember, a
                                Setting is a bridge allowing communication
                                between a Control and it’s related Partial.<br />So
                                when a communication occurs, a change is ongoing
                                and then done !<br />In the example above, we
                                are listening to any change on the
                                <code>background_image</code>.
                            </p>
                            <p>
                                Did you try to look for
                                <code>background_image</code> in the generated
                                theme from underscores ?!<br />If you did, you
                                know by now that it’s not here 🤔 and if you
                                didn’t, don’t, you will not find it !<br />Well,
                                I’ve used it as an example to grab your
                                attention on Core Controls/Settings !<br />Some
                                Controls/Settings comes with WordPress by
                                default, they can be modified or removed, but
                                this will be for another article.
                            </p>
                            <p>
                                I didn’t forget, I just delayed it 😈<br />The
                                code above should go inside
                                <strong>customizer.js</strong> between a :
                            </p>
                            <pre><code>(function ($) { ... YES HERE ... } (jQuery));</code></pre>
                            <p>I really hope that this will be useful.</p>
                            <p>SYA,<br />LebCit</p>
                        </div>
                    </section>
                </div>

                <div class="footer"></div>
            </div>
        </div>

        <script src="/global.js"></script>
    </body>
</html>
