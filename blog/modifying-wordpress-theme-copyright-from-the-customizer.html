<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <!-- Page Info -->
        <title>
            Modifying WordPress theme's copyright from the Customizer &ndash;
            &lbrace; LebCit &rbrace;
        </title>
        <meta name="theme-color" content="#3d4f5d" />
        <meta
            name="description"
            content="This post is about modifying WordPress theme's copyright from the Customizer."
        />

        <!-- Favicon -->
        <link
            rel="icon"
            type="image/png"
            sizes="16x16"
            href="/img/favicon//favicon-16x16.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="32x32"
            href="/img/favicon/favicon-32x32.png"
        />
        <link
            rel="apple-touch-icon"
            sizes="180x180"
            href="/img/favicon/apple-touch-icon.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="192x192"
            href="/img/favicon/android-chrome-192x192.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="512x512"
            href="/img/favicon/android-chrome-512x512.png"
        />

        <!-- Styles -->
        <link rel="stylesheet" href="/vendor/normalize-min.css" />
        <link rel="stylesheet" href="/style.css" />
    </head>

    <body class="copyright-customizer">
        <div id="layout" class="grid">
            <a class="skip-link screen-reader-text" href="#content"
                >Skip to content</a
            >

            <main-nav></main-nav>

            <the-header></the-header>

            <div id="content" class="content unit-1 unit-lg-3-5">
                <!-- A wrapper for every single post -->
                <div class="single-post">
                    <!-- A single post -->
                    <section class="post-single">
                        <header class="post-header">
                            <h2 class="post-title">
                                Modifying WordPress theme's copyright from the
                                Customizer
                            </h2>

                            <p class="post-meta">
                                Posted on
                                <span class="posted-on">21 May 2020</span>
                                under
                                <span class="post-category">Tips & Tricks</span>
                            </p>
                        </header>

                        <div class="post-content">
                            <p>
                                <em
                                    >This post is about modifying WordPress
                                    theme's copyright from the Customizer.</em
                                ><br /><br />If you are new to the Customizer,
                                don't be afraid, I was too a long time ago...<br />So
                                in this post I'll show you a technique to
                                control the copyright of WordPress, generally
                                displayed in the footer of a theme, from the
                                Customizer.<br />You can use it in your own
                                theme to give your users a clean and easy way to
                                modify the footer copyright, or use it in a
                                child theme to modify the footer copyright of
                                the parent theme that you are using.
                            </p>
                            <h2>
                                1- Replace the footer copyright by a function
                            </h2>
                            <p>
                                First of all select the part that should be
                                modified. Generally speaking, it's a sentence
                                like: "<em
                                    >Proudly powered by WordPress, Theme:
                                    theme-name by theme-author</em
                                >".<br />I'm going to take the generated footer
                                by
                                <a
                                    target="_blank"
                                    rel="noopener"
                                    href="https://underscores.me/"
                                    >_s</a
                                >
                                (underscores) as an example for this task.<br />Looking
                                inside the <strong>footer.php</strong>, we can
                                see a code like this:
                            </p>
                            <pre><code>&lt;footer id="colophon" class="site-footer"&gt;
    &lt;div class="site-info"&gt;
        &lt;a href="&lt;?php echo esc_url( __( 'https://wordpress.org/', 'midday' ) ); ?&gt;"&gt;
            &lt;?php
            /* translators: %s: CMS name, i.e. WordPress. */
            printf( esc_html__( 'Proudly powered by %s', 'midday' ), 'WordPress' );
            ?&gt;
        &lt;/a&gt;
        &lt;span class="sep"&gt; | &lt;/span&gt;
            &lt;?php
            /* translators: 1: Theme name, 2: Theme author. */
            printf( esc_html__( 'Theme: %1$s by %2$s.', 'midday' ), 'midday', '&lt;a href="https://github.com/LebCit"&gt;LebCit&lt;/a&gt;' );
            ?&gt;
    &lt;/div&gt;&lt;!-- .site-info --&gt;
&lt;/footer&gt;&lt;!-- #colophon --&gt;</code></pre>
                            <p>
                                Here, we are interested with the code inside
                                <code>&lt;div class="site-info"&gt;</code>, so
                                let's cut it, paste it somewhere else (like
                                notepad), and replace it by a php function.<br />The
                                code should now be like the following:
                            </p>
                            <pre><code>&lt;footer id="colophon" class="site-footer"&gt;
    &lt;div id="site-info" class="site-info"&gt;
        &lt;?php midday_site_info(); ?&gt;
    &lt;/div&gt;&lt;!-- .site-info --&gt;
&lt;/footer&gt;&lt;!-- #colophon --&gt;</code></pre>

                            <p>
                                You can name the function whatever you like, but
                                be sure to replace any name modification
                                according to the changes you have made in the
                                wright place in the code.<br />Please note that
                                I've added an
                                <code>&lt;id="site-info"&gt;</code> this will be
                                used in the Customizer.
                            </p>
                            <h2>
                                2- Put the footer copyright in functions.php
                            </h2>
                            <p>
                                Now we have to connect this
                                <code>midday_site_info()</code> function with
                                the block of code previously pasted
                                elsewhere.<br />In the functions.php file of
                                your theme or your child theme, put this code,
                                I'll explain it just after :
                            </p>

                            <pre><code>/**
 * Output the theme's copyright depending on user's choice.
 */
function midday_site_info() {
    $midday_footer_copyright_area_checkbox = get_theme_mod( 'midday_footer_copyright_area_checkbox', true );
    $midday_custom_copyright_textarea      = get_theme_mod( 'midday_custom_copyright_textarea', '' );
    if ( ! empty( $midday_footer_copyright_area_checkbox ) ) :
            $html  = '&lt;a href="' . esc_url( 'https://wordpress.org/' ) . '"&gt;' . esc_html( 'Proudly powered by WordPress' ) . '&lt;/a&gt;';
            $html .= '&lt;span class="sep"&gt; | &lt;/span&gt;';
            $html .= esc_html( 'Theme: MidDay by ' ) . '&lt;a href="' . esc_url( 'https://lebcit.github.io/' ) . '"&gt;' . esc_html( 'LebCit' ) . '&lt;/a&gt;';
            echo wp_kses(
                $html,
                array(
                    'a'  =&gt; array(
                        'href' =&gt; array(),
                    ),
                    'span'  =&gt; array(
                        'class' =&gt; array(),
                    ),
                )
            );
    elseif ( empty( $midday_footer_copyright_area_checkbox ) &amp;&amp; ! empty( $midday_custom_copyright_textarea ) ) :
        echo wp_kses_post( $midday_custom_copyright_textarea ); // Allow html.
    endif;
}</code></pre>
                            <p>
                                What in the hell is this ?<br />&emsp; It's
                                nothing üòÇ it's just the same pasted elsewhere
                                code in PHP with some variables and an
                                <code>if/elseif</code> statement to take care of
                                the user's choice.<br />&emsp; Inside the
                                function, I've defined 2 variables. Each one is
                                related to a <code>theme_mod</code> (theme
                                modification) that we will create and explain in
                                a moment.<br />&emsp; I've opened an
                                <code>if</code> statement saying:<br /><em
                                    >if the first variable (remember it's
                                    related to a <code>theme_mod</code>, yes
                                    it's a checkbox üòâ) is not empty (so it have
                                    a check tick, it's checked) please populate
                                    the copyright with the following code</em
                                >.<br />&emsp; The code here is pretty easy to
                                understand.<br />I've defined an
                                <code>$html</code> variable replicating the
                                pasted elsewhere code, then I've asked PHP to
                                echo this code using
                                <a
                                    target="_blank"
                                    rel="noopener"
                                    href="https://developer.wordpress.org/reference/functions/wp_kses/"
                                    ><code>wp_kses</code></a
                                >
                                filtering the text content and striping out
                                disallowed HTML.<br />&emsp; In other words:<br /><em
                                    >hey <code>wp_kses</code>, please echo the
                                    defined <code>$html</code> variable, and
                                    please allow it to only have
                                    <code>a</code> tag with
                                    <code>href</code> attribute and
                                    <code>span</code> tag with
                                    <code>class</code> attribute, thank you very
                                    much</em
                                >
                                üòä<br />&emsp; After that, I've opened an
                                <code>elseif</code> statement saying:<br /><em
                                    >okay, if the first variable is empty (the
                                    checkbox is not checked) and the second
                                    variable (a text area) is not empty, please
                                    populate the copyright with the content of
                                    the text area allowing the user to use HTML
                                    inside it with </em
                                ><a
                                    target="_blank"
                                    rel="noopener"
                                    href="https://developer.wordpress.org/reference/functions/wp_kses_post/"
                                    ><em><code>wp_kses_post</code></em></a
                                ><em>
                                    that will keep an eye and make sure the user
                                    type allowed HTML only, that's it I've
                                    nothing more to ask so please close the if
                                    statement with this <code>endif;</code></em
                                >
                            </p>
                            <h2>
                                3- Create settings and controls in the
                                Customizer
                            </h2>
                            <p>
                                &emsp; Do you remember the 2 previous variables
                                ? They where related to theme's modifications.
                                It's time to create those
                                <code>theme_mod</code> and test our code.<br />&emsp;
                                To keep the functions.php file clean, we will
                                put the following in a customizer.php file if
                                you don't have one already. Yous just have to
                                require it from functions.php like so :
                            </p>
                            <pre><code>require get_template_directory() . '/inc/customizer.php';</code></pre>
                            <p>
                                &emsp; Please note that in this example the file
                                is in a folder named inc (for includes) at the
                                root of the theme or the child theme, you can
                                change this but be sure to indicate the correct
                                path.<br />&emsp; Now, put the following in
                                customizer.php, let's see the code and explain
                                it later:
                            </p>
                            <pre><code>function midday_customize_register( $wp_customize ) {
    /**
     * MidDay Theme Panel
     */
    $wp_customize-&gt;add_panel(
        'midday_panel',
        array(
            'title'       =&gt; __( 'MidDay Theme', 'midday' ),
            'description' =&gt; esc_html__( 'Customize MidDay Theme', 'midday' ),
            'priority'    =&gt; 0,
        )
    );

    /**
     * Footer Copyright Area Section.
     */
    $wp_customize-&gt;add_section(
        'midday_footer_copyright_area_section',
        array(
            'title'       =&gt; esc_html__( 'Footer Copyright Area', 'midday' ),
            'description' =&gt; __( 'Modify &lt;b&gt;Footer Copyright Area&lt;/b&gt;.', 'midday' ),
            'panel'       =&gt; 'midday_panel',
            'priority'    =&gt; 15,
        )
    );

    // Default copyright.
    $wp_customize-&gt;add_setting(
        'midday_footer_copyright_area_checkbox',
        array(
            'default'           =&gt; true,
            'transport'         =&gt; 'postMessage',
            'sanitize_callback' =&gt; 'midday_sanitize_checkbox',
        )
    );

    $wp_customize-&gt;add_control(
        'midday_footer_copyright_area_checkbox',
        array(
            'label'       =&gt; __( 'Enable/Disable Default Copyright.', 'midday' ),
            'description' =&gt; __( 'This checkbox, once &lt;b&gt;unchecked&lt;/b&gt;,&lt;br&gt;removes &lt;b&gt;Default Copyright.&lt;/b&gt;', 'midday' ),
            'section'     =&gt; 'midday_footer_copyright_area_section',
            'type'        =&gt; 'checkbox',
        )
    );

    $wp_customize-&gt;selective_refresh-&gt;add_partial(
        'midday_footer_copyright_area_checkbox',
        array(
            'selector'        =&gt; '#site-info',
            'settings'        =&gt; array( 'midday_footer_copyright_area_checkbox' ),
            'render_callback' =&gt; 'midday_site_info',
        )
    );

    // Custom copyright.
    $wp_customize-&gt;add_setting(
        'midday_custom_copyright_textarea',
        array(
            'default'           =&gt; '',
            'transport'         =&gt; 'postMessage',
            'sanitize_callback' =&gt; 'wp_kses_post', // Allow html.
        )
    );

    $wp_customize-&gt;add_control(
        'midday_custom_copyright_textarea',
        array(
            'label'       =&gt; esc_html__( 'Custom Copyright Textarea', 'midday' ),
            'description' =&gt; __( 'To display a &lt;b&gt;Custom Copyright&lt;/b&gt;,&lt;br&gt;&lt;b&gt;uncheck&lt;/b&gt; the &lt;b&gt;Default Copyright&lt;/b&gt; checkbox,&lt;br&gt;then type a custom copyright in the textarea.&lt;br&gt;&lt;b&gt;HTML&lt;/b&gt; is allowed !', 'midday' ),
            'section'     =&gt; 'midday_footer_copyright_area_section',
            'type'        =&gt; 'textarea',
            'input_attrs' =&gt; array(
                'style'       =&gt; 'border: 1px solid #999',
                'placeholder' =&gt; __( 'Enter Custom Copyright...', 'midday' ),
            ),
        )
    );

    $wp_customize-&gt;selective_refresh-&gt;add_partial(
        'midday_custom_copyright_textarea',
        array(
            'selector'        =&gt; '#site-info',
            'settings'        =&gt; array( 'midday_custom_copyright_textarea' ),
            'render_callback' =&gt; 'midday_site_info',
        )
    );

}
add_action( 'customize_register', 'midday_customize_register' );</code></pre>

                            <p>
                                Don't panic, it's pretty straightforward !<br />Let's
                                break it down and you'll see.
                            </p>
                            <pre><code>function mytheme_customize_register( $wp_customize )
{
    //All our sections, settings, and controls will be added here
}
add_action( 'customize_register', 'mytheme_customize_register' );</code></pre>
                            <p>
                                &emsp; This is how we hook a function to the
                                <a
                                    target="_blank"
                                    rel="noopener"
                                    href="https://codex.wordpress.org/Plugin_API/Action_Reference/customize_register"
                                    ><code>'customize_register'</code></a
                                >
                                action and put inside it our panels, sections,
                                settings and controls.<br />&emsp; Looking at
                                our code, you can now understand that I've
                                created a panel, a section, 2 settings and their
                                2 related controls.<br />&emsp; I'm not going to
                                dive into the Customizer, but if you're not
                                familiar with it, a good start would be this
                                <a
                                    target="_blank"
                                    rel="noopener"
                                    href="https://maddisondesigns.com/2017/05/the-wordpress-customizer-a-developers-guide-part-1/"
                                    >excellent guide</a
                                >
                                by Anthony Hortin.<br />&emsp; Instead, I'm
                                going to explain a more important aspect here.
                                If you take a good look at the code, you'll see
                                something else under each control :
                            </p>
                            <pre><code>$wp_customize-&gt;selective_refresh-&gt;add_partial</code></pre>
                            <p>
                                What is this and what does it do ?<br />Well,
                                look closer and you'll figure it out yourself
                                üòÇ<br />
                                Just kidding, but in fact it's really clear.<br />Let's
                                take one setting it's control and the related
                                selective_refresh:
                            </p>
                            <pre><code>// Default copyright.
$wp_customize-&gt;add_setting(
    'midday_footer_copyright_area_checkbox',
    array(
        'default'           =&gt; true,
        'transport'         =&gt; 'postMessage',
        'sanitize_callback' =&gt; 'midday_sanitize_checkbox',
    )
);

$wp_customize-&gt;add_control(
    'midday_footer_copyright_area_checkbox',
    array(
        'label'       =&gt; __( 'Enable/Disable Default Copyright.', 'midday' ),
        'description' =&gt; __( 'This checkbox, once &lt;b&gt;unchecked&lt;/b&gt;,&lt;br&gt;removes &lt;b&gt;Default Copyright.&lt;/b&gt;', 'midday' ),
        'section'     =&gt; 'midday_footer_copyright_area_section',
        'type'        =&gt; 'checkbox',
    )
);

$wp_customize-&gt;selective_refresh-&gt;add_partial(
    'midday_footer_copyright_area_checkbox',
    array(
        'selector'        =&gt; '#site-info',
        'settings'        =&gt; array( 'midday_footer_copyright_area_checkbox' ),
        'render_callback' =&gt; 'midday_site_info',
    )
);</code></pre>

                            <p>
                                Remember the first variable ?<br />Well here is
                                it's theme_mod !<br />Take a look at the
                                <strong>setting</strong> name
                                <code
                                    >midday_footer_copyright_area_checkbox</code
                                >
                                üòâ<br />The important part here is
                                <code>'transport' =&gt; 'postMessage'</code>,
                                because it tells the browser not to reload, but
                                to make the change(s) in place !<br />Another
                                important aspect in the
                                <strong>setting</strong> is
                                <code
                                    >'sanitize_callback' =&gt;
                                    'midday_sanitize_checkbox'</code
                                >, this is a function to sanitize the checkbox,
                                you should put it <strong>after</strong> the
                                <code>'customize_register'</code> action hook:
                            </p>
                            <pre><code>if ( ! function_exists( 'midday_sanitize_checkbox' ) ) {
    /**
        * Switch sanitization
        *
        * @param string $input Switch value.
        * @return integer  Sanitized value
        */
    function midday_sanitize_checkbox( $input ) {
        if ( false === $input ) {
            return 0;
        } else {
            return 1;
        }
    }
}</code> </pre>
                            <p>
                                In the <strong>control</strong>, the important
                                part is the type of the control, as you can see
                                it's defined as checkbox, no surprise, WYaskIWYG
                                üòÇ<br />For the <strong>partial</strong>, the
                                important part is the selector, it must be an
                                <code>id</code>, now you know why I've added an
                                <code>id</code> previously üëç<br />If you look
                                at the <code>settings</code> and the
                                <code>render_callback</code> of the
                                <strong>partial</strong>, you'll understand that
                                everything is related üîó and that we are just
                                putting the wright piece in the wright place
                                üß©<br /><br />You maybe guessed it out or not,
                                but yes I'm developing a new theme called MidDay
                                (in fact I've finished it, just some clean up
                                remaining) and I'll submit it very soon üòÅ<br /><br />I
                                really hope that this was helpful.<br />SYA,<br />LebCit.
                            </p>
                        </div>
                    </section>
                </div>

                <div class="footer"></div>
            </div>
        </div>

        <script src="/global.js"></script>
    </body>
</html>
